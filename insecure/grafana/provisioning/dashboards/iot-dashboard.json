{
  "title": "IoT Cyber Range ‚Äî Security Dashboard",
  "uid": "iot-cyber-range",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "5s",
  "time": { "from": "now-15m", "to": "now" },
  "tags": ["iot", "security", "thesis"],
  "panels": [
    {
      "id": 1, "title": "üü¢ Device Online Status",
      "type": "stat", "gridPos": { "x": 0, "y": 0, "w": 4, "h": 4 },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none", "textMode": "value_and_name" },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "mappings": [{ "type": "value", "options": { "0": { "text": "OFFLINE" }, "1": { "text": "ONLINE" } } }] } },
      "targets": [{ "expr": "iot_device_online", "legendFormat": "{{device}}", "datasource": "Prometheus" }]
    },
    {
      "id": 2, "title": "üö® Total Injected Commands",
      "type": "stat", "gridPos": { "x": 4, "y": 0, "w": 4, "h": 4 },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": 0 }, { "color": "orange", "value": 1 }, { "color": "red", "value": 5 }] }, "unit": "short" } },
      "targets": [{ "expr": "sum(iot_attack_commands_total)", "legendFormat": "Injected commands", "datasource": "Prometheus" }]
    },
    {
      "id": 3, "title": "üîì Unauthorized Unlock Events",
      "type": "stat", "gridPos": { "x": 8, "y": 0, "w": 4, "h": 4 },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": 0 }, { "color": "red", "value": 1 }] }, "unit": "short" } },
      "targets": [{ "expr": "sum(iot_attack_unlock_total)", "legendFormat": "Unlock events", "datasource": "Prometheus" }]
    },
    {
      "id": 4, "title": "‚ò†Ô∏è Data Poisoning Events",
      "type": "stat", "gridPos": { "x": 12, "y": 0, "w": 4, "h": 4 },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": 0 }, { "color": "red", "value": 1 }] } } },
      "targets": [{ "expr": "sum(iot_attack_poison_total)", "legendFormat": "Poisoned messages", "datasource": "Prometheus" }]
    },
    {
      "id": 5, "title": "üì® Total MQTT Messages",
      "type": "stat", "gridPos": { "x": 16, "y": 0, "w": 4, "h": 4 },
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "value", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "palette-classic" } } },
      "targets": [{ "expr": "sum(iot_messages_total)", "legendFormat": "Total messages", "datasource": "Prometheus" }]
    },
    {
      "id": 6, "title": "üå°Ô∏è Temperature ‚Äî device-001",
      "type": "timeseries", "gridPos": { "x": 0, "y": 4, "w": 8, "h": 7 },
      "options": { "tooltip": { "mode": "single" }, "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "celsius", "color": { "mode": "palette-classic" }, "custom": { "lineWidth": 2, "fillOpacity": 15 } } },
      "targets": [{ "expr": "iot_sensor_value{device=\"device-001\"}", "legendFormat": "Temperature (¬∞C)", "datasource": "Prometheus" }]
    },
    {
      "id": 7, "title": "üíß Humidity ‚Äî device-002",
      "type": "timeseries", "gridPos": { "x": 8, "y": 4, "w": 8, "h": 7 },
      "options": { "tooltip": { "mode": "single" }, "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "percent", "color": { "mode": "palette-classic" }, "custom": { "lineWidth": 2, "fillOpacity": 15 } } },
      "targets": [{ "expr": "iot_sensor_value{device=\"device-002\"}", "legendFormat": "Humidity (%)", "datasource": "Prometheus" }]
    },
    {
      "id": 8, "title": "üö™ Door Lock ‚Äî device-003  (1 = locked, 0 = unlocked)",
      "type": "timeseries", "gridPos": { "x": 16, "y": 4, "w": 8, "h": 7 },
      "options": { "tooltip": { "mode": "single" }, "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "short", "min": 0, "max": 1, "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "red", "value": 0 }, { "color": "green", "value": 1 }] }, "custom": { "lineWidth": 2, "fillOpacity": 30 }, "mappings": [{ "type": "value", "options": { "0": { "text": "UNLOCKED üîì", "color": "red" }, "1": { "text": "LOCKED üîí", "color": "green" } } }] } },
      "targets": [{ "expr": "iot_sensor_value{device=\"device-003\"}", "legendFormat": "Lock state", "datasource": "Prometheus" }]
    },
    {
      "id": 9, "title": "‚öîÔ∏è Attack Timeline ‚Äî Injected Commands per Device",
      "type": "timeseries", "gridPos": { "x": 0, "y": 11, "w": 12, "h": 8 },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "palette-classic" }, "custom": { "lineWidth": 2, "fillOpacity": 20 } } },
      "targets": [{ "expr": "increase(iot_attack_commands_total[1m])", "legendFormat": "{{device}} ‚Äî commands/min", "datasource": "Prometheus" }]
    },
    {
      "id": 10, "title": "üìä Message Rate per Device (1m window)",
      "type": "timeseries", "gridPos": { "x": 12, "y": 11, "w": 12, "h": 8 },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "palette-classic" }, "custom": { "lineWidth": 2, "fillOpacity": 10 } } },
      "targets": [{ "expr": "increase(iot_messages_per_device[1m])", "legendFormat": "{{device}}", "datasource": "Prometheus" }]
    },
    {
      "id": 11, "title": "üîì Unauthorized Unlocks by Device",
      "type": "barchart", "gridPos": { "x": 0, "y": 19, "w": 8, "h": 7 },
      "options": { "orientation": "vertical", "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": 0 }, { "color": "red", "value": 1 }] } } },
      "targets": [{ "expr": "iot_attack_unlock_total", "legendFormat": "{{device}}", "datasource": "Prometheus", "instant": true }]
    },
    {
      "id": 12, "title": "‚ò†Ô∏è Data Poisoning Events by Device",
      "type": "barchart", "gridPos": { "x": 8, "y": 19, "w": 8, "h": 7 },
      "options": { "orientation": "vertical", "legend": { "displayMode": "list", "placement": "bottom" } },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "color": "green", "value": 0 }, { "color": "red", "value": 1 }] } } },
      "targets": [{ "expr": "iot_attack_poison_total", "legendFormat": "{{device}}", "datasource": "Prometheus", "instant": true }]
    },
    {
      "id": 13, "title": "üì° MQTT Traffic Distribution by Topic",
      "type": "piechart", "gridPos": { "x": 16, "y": 19, "w": 8, "h": 7 },
      "options": { "pieType": "donut", "legend": { "displayMode": "list", "placement": "right" } },
      "fieldConfig": { "defaults": { "unit": "short", "color": { "mode": "palette-classic" } } },
      "targets": [{ "expr": "iot_messages_total", "legendFormat": "{{topic}}", "datasource": "Prometheus", "instant": true }]
    }
  ]
}
